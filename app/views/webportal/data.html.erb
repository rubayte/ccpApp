<div class="row-fluid">

	<div class="container">
		
		<div span="12">
			      <h3> add the new subtypes to existing sub types </h3>	
				<p>
      					<b>Data and resources files</b> &nbsp;
      					<%=  link_to_modal "Upload new file", "#uploadFile", :class=>"btn btn-primary btn-medium" %>
	    		</p>			
	    				<% @dirItems.each do |key,value| -%>
					    		<div class="container">
					    			<div class="header"><span><i class="icon-folder-open"></i><%= key %> /</span>
	    							</div>
    								<div class="content">
    									<table class="table table-condensed">
										<% files = value.split("#") -%>
										<% files.each do |fs| -%>
										    <tr>
										    <% f = fs.split(";") -%>
										    <% fdetails = f[1].split(",") -%>
										    <% if fdetails[2] == "data" -%>	
										    	<td><i class="icon-file"></i><span style="color:blue" title="data file"><%= f[0] %></span></td>
										    <% else -%>
										    	<td><i class="icon-file"></i><span style="color:green" title="resource file"><%= f[0] %></span></td>
										    <% end -%>	
											<td>created by: <%= link_to fdetails[0], {:controller => "webportal", :action => "getProfile",:useridvalue => fdetails[0] } %></td>
											<td><td>created on: <%= fdetails[4] %></td>
											<td>actions:
											<i class="icon-eye-open"></i> View |
											<i class="icon-download"></i> <%= link_to :"Download", {:controller => "webportal", :action => "download",:file => key + "/"+ f[0]} %>
											</td>
											<% if fdetails[3].length > 10 -%>
												<td><span title="<%= fdetails[3]%>">comments: <%= fdetails[3][0, 9] + " .." %></span></td>
											<% else -%>	
												<td>comments: <%= fdetails[3] %></td>
											<% end -%>	
											</tr>							
										<% end -%>
										</table>	
									</div>
								</div>
						<% end -%>
      					
		</div>
	</div>
</div>

<div id="uploadFile" class="modal" style="display: none; ">

	<div class="modal-header">
		<h3>Upload data and resources files</h3>
	</div>
	<div class="modal-body">
	<%= form_tag({:controller => 'webportal',:action => 'uploadFiles'}, :multipart => true) do %>
		File: <%= file_field_tag 'file'%><br><br>
		Type: <%= select_tag "fileType", options_for_select(@ftypes) %><br><br>
		Cancer type: <%= select_tag "wgType", options_for_select(@wgtypes) %><br><br>
		Sub type: <%= select_tag "sType", options_for_select(@stypes) %><br><br>
		<input type="checkbox" id="newSubTypeCheckbox" name="newSubTypeCheckbox" value="yes" onclick="javascript:toggletextBox();"/> 
		Cretae new sub type: <%= text_field_tag "newSubType", '', disabled: true %> <br><br>
		Comments: <%= text_area_tag 'comments', nil, size: "5x5" %><br><br>
	</div>
	<div class="modal-footer">
	    <%= submit_tag 	"Upload",  :class => 'btn btn-primary btn-medium' %>
	<% end %>
	</div>
</div>


<script type="text/javascript">
function toggletextBox()
    {
    if (document.getElementById('newSubTypeCheckbox').checked == true)
      {
      document.getElementById('newSubType').removeAttribute('disabled');
      }
    else
      {
      document.getElementById('newSubType').setAttribute('disabled','disabled');
      }
    }
</script>
<script type="text/javascript">
$(".header").click(function () {

    $header = $(this);
    //getting the next element
    $content = $header.next();
    //open up the content needed - toggle the slide- if visible, slide up, if not slidedown.
    $content.slideToggle(500, function () {
        //execute this after slideToggle is done
        //change text of header based on visibility of content div
        $header.text(function () {
            //change text based on condition	
            return $content.is(":visible") ? $header["\u2215"] : $header["\u2215"] ;
        });
    });

});
</script>